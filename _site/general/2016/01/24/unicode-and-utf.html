<!DOCTYPE html>
<html lang="en" id="blog">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Unicodeå’ŒUTFåŸºç¡€</title>
  <link rel="stylesheet" href="/assets/css/style.css">
  <link rel="icon" type="image/jpeg" href="http://7xio0w.com1.z0.glb.clouddn.com/avatar.jpg">

</head>
<body>

  <div class="wrapper">


    
<header>
  <ul class="page-nav">
    <li><a href="/index.html">é¦–é¡µ</a></li>
    <li><a href="/article.html">æ–‡ç« </a></li>
    <li><a href="/demo.html">Demo</a></li>
    <li><a href="/outlink.html">å¥½å‹</a></li>
    <li><a href="/about.html">About</a></li>
  </ul>


    <div style="min-height: 64px;">
      <script>
  (function() {
    var cx = '000120512111193585777:jcbgjxdhzuq';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
    </div>
</header>



    <div class="markdown-body">
      è½¬è½½è¯·æ³¨æ˜å‡ºå¤„: <a href="http://qiudeqing.com/general/2016/01/24/unicode-and-utf.html">http://qiudeqing.com/general/2016/01/24/unicode-and-utf.html</a>

      <h1 id="unicode">Unicode</h1>

<p>Unicodeæ˜¯ä¸€ä¸ªå­—ç¬¦é›†, ä¸ºæ¯ä¸€ä¸ªå­—ç¬¦æä¾›ä¸€ä¸ªå”¯ä¸€çš„ç¼–å·, ç”±<a href="http://www.unicode.org/consortium/consort.html">Unicode Consortium</a>ç»´æŠ¤.</p>

<p>è¯¦ç»†ä¿¡æ¯å‚è€ƒ<a href="https://en.wikipedia.org/wiki/Unicode">wikipedia: Unicode</a>, <a href="http://www.unicode.org/">http://www.unicode.org/</a></p>

<h1 id="code-point">code point</h1>

<p>Unicodeä¸ºå­—ç¬¦æä¾›çš„å”¯ä¸€ç¼–å·å«åš<code>code point</code>æˆ–è€…<code>code position</code>.</p>

<h1 id="unicode-plane">Unicode Plane</h1>

<p>åœ¨Unicodeæ ‡å‡†ä¸­, ä¸€ä¸ª<a href="https://en.wikipedia.org/wiki/Plane_(Unicode)">plane</a>ç”±è¿ç»­çš„<strong>65536(2çš„åå…­æ¬¡æ–¹)</strong> ä¸ªcode pointç»„æˆ.</p>

<p>ä¸€å…±æœ‰17ä¸ªplane, ä½ç½®ç¼–ç çš„å‰ä¸¤ä½è¡¨ç¤ºplaneç¼–ç , å³<strong>hh hhhh</strong>çš„å‰ä¸¤ä½.</p>

<p>plane 0 å«åš<a href="https://en.wikipedia.org/wiki/Plane_(Unicode)#Basic_Multilingual_Plane">Basic Multilingual Plane</a>, å…¶ä½™çš„planeå«åšSupplementary plane</p>

<h1 id="basic-multilingual-plane">Basic Multilingual Plane</h1>

<p>BMPå‡ ä¹åŒ…æ‹¬ç°ä»£è¯­è¨€çš„æ‰€æœ‰å­—ç¬¦å’Œå¤§é‡å›¾æ ‡. å…¶ä¸­çš„å¤§éƒ¨åˆ†code pointç”¨äºç¼–ç <a href="https://en.wikipedia.org/wiki/CJK_characters">CJKå­—ç¬¦</a></p>

<h1 id="utf">UTF</h1>

<p>Unicode Transformation Format(UTF)æ˜¯ç”¨äºå°†æ¯ä¸€ä¸ªUnicode code pointæ˜ å°„ä¸ºä¸€ä¸ªå”¯ä¸€çš„å­—èŠ‚åºåˆ—çš„ç¼–ç ç®—æ³•. å¸¸è§çš„ç¼–ç ç®—æ³•æœ‰UTF8, UTF-16, UTF-32.</p>

<h1 id="code-unit">code unit</h1>

<p>ç¼–ç ç®—æ³•ç”¨äºè¡¨ç¤ºå­—ç¬¦çš„æœ€å°bité•¿åº¦, å¦‚UTF8çš„code unitæ˜¯8, UTF16çš„code unitæ˜¯16</p>

<h1 id="utf8">UTF8</h1>

<p><a href="https://en.wikipedia.org/wiki/UTF-8">UTF8</a>çš„code unitä¸º8 bit</p>

<h1 id="utf8-1">è®¡ç®—å­—ç¬¦ä¸²åœ¨utf8ç¼–ç çš„å­—èŠ‚é•¿åº¦</h1>

<p>JavaScriptå­—ç¬¦ä¸²æ˜¯utf16ç¼–ç , å¸¸ç”¨çš„charAt(), getCharCode(), lengthéƒ½æ˜¯åŸºäºutf16çš„code unit, å½“å­—ç¬¦åœ¨Unicodeçš„Basic Multilingual Planeå†…æ—¶éƒ½å¯ä»¥æ­£å¸¸å·¥ä½œ,<br />
è®¡ç®—utf8ç¼–ç é•¿åº¦éœ€è¦ä½¿ç”¨åŸºäºcode pointçš„å‡½æ•°, è‡ªå·±æ‰‹åŠ¨å®ç°ç¼–ç è½¬æ¢è‚¯å®šä¸ç°å®, åº”è¯¥ä½¿ç”¨å¯¹åº”çš„å­—ç¬¦ä¸²å¤„ç†åº“.</p>

<p>æ­£åˆ™è¡¨è¾¾å¼ä¹Ÿæ˜¯åŸºäºcode unitçš„.</p>

<p>å¹³æ—¶æˆ‘ä»¬ç”¨è¿™äº›æ–¹æ³•éƒ½æ²¡ä»€ä¹ˆé—®é¢˜æ˜¯å› ä¸ºå¹³æ—¶æ¥è§¦åˆ°çš„å­—ç¬¦éƒ½åœ¨Basic Multilingual Planeä¸‹é¢, <a href="http://www.amazon.com/gp/product/0321812182/ref=s9_simh_gw_g14_i2_r?pf_rd_m=ATVPDKIKX0DER&amp;pf_rd_s=desktop-1&amp;pf_rd_r=13FW4ZZT7X3ED06YGY7T&amp;pf_rd_t=36701&amp;pf_rd_p=2079475242&amp;pf_rd_i=desktop">Effective JavaScript</a>ä¸­ç¬¬ä¸ƒæ¡: <strong>Think of Strings As Sequences of 16-bit code units</strong>æœ‰è¯¦ç»†è§£é‡Š, æ•´æœ¬ä¹¦ä¹Ÿæ¯”è¾ƒä¸é”™. ç”µå­ç‰ˆæˆ‘æ”¾åˆ°äº†é™„ä»¶ä¸­, æ•´æœ¬ä¹¦æ²¡æœ‰åºŸè¯, éƒ½æ˜¯å¹²æ´», å¼ºçƒˆæ¨è</p>

<p>æµè§ˆå™¨ä¸‹çš„encodeURI, decodeURI, encodeURIComponent, decodeURIComponentåˆšå¥½å°±æ˜¯ä»¥code pointå·¥ä½œçš„, æˆ‘ä»¬ä½¿ç”¨encodeURIComponent</p>

<p>å› ä¸ºencodeURIComponentä¸è½¬ä¹‰: å­—æ¯ æ•°å­— - _ . ! ~ * â€˜ ( ) éœ€è¦æŠŠè¿™éƒ¨åˆ†å…ˆæå–å‡ºæ¥, è®¡ç®—é•¿åº¦,</p>

<p>å‰©ä¸‹çš„è½¬ä¹‰, è®¡ç®—é•¿åº¦</p>

<pre><code>var util = {
    /**
     * è®¡ç®—å­—ç¬¦ä¸²åœ¨utf8ç¼–ç çš„å­—èŠ‚é•¿åº¦
     * @param str {string} éœ€è¦è®¡ç®—å­—èŠ‚é•¿åº¦çš„å­—ç¬¦ä¸²
     * @return {number}  å­—ç¬¦ä¸²åœ¨utf8ç¼–ç ä¸‹çš„å­—èŠ‚é•¿åº¦
     **/
    utf8ByteLength: function (str) {
        str = str || ''
        var plainReg = /[\w-\.!~*'\(\)']/g
        var utf8TokenReg = /%\w{2}/g
        var plainTokens = str.match(plainReg) || []
        var complexStr = str.replace(plainReg, '')
        var encodedStr = encodeURIComponent(complexStr)
        var utf8Tokens = encodedStr.match(utf8TokenReg) || []
        return plainTokens.length + utf8Tokens.length
    }
}


console.log(util.utf8ByteLength('a'))   // 1
console.log(util.utf8ByteLength('Â¢'))   // 2
console.log(util.utf8ByteLength('ä¸­'))   // 3
console.log(util.utf8ByteLength('ğˆ'))   // 4
</code></pre>


    </div>

    

<footer>
  <ul class="page-nav">
    <li class="github">
      <a href="https://github.com/qiu-deqing">
        <img height="58" src="https://cloud.githubusercontent.com/assets/5894015/9272138/ffaf6984-42b1-11e5-8b74-cef26c1e5129.png"></a>
    </li>
    <li class="stackoverflow">
      <a href="http://stackoverflow.com/users/3004355/qiu-deqing">
        <img src="http://stackoverflow.com/users/flair/3004355.png" width="208" height="58" alt="profile for qiu-deqing at Stack Overflow, Q&amp;A for professional and enthusiast programmers" title="profile for qiu-deqing at Stack Overflow, Q&amp;A for professional and enthusiast programmers">
      </a>
    </li>
    <li><a href="http://weibo.com/u/2042986003">å¾®åš</a></li>
  </ul>
  <p>Â© 2015-- é‚±å¾·æ¸…</p>
</footer>

<div class="page-scroll-container"></div>

<script src="/assets/js/dome.js"></script>
<script>
  (function (w) {
    var doc = w.document;


    // ç±»åˆ«å¯¼èˆªé«˜äº®
    var list = doc.querySelectorAll('.page-nav a');

    // è·å–å½“å‰é¡µé¢ç¬¬ä¸€ä¸ª/å’Œç¬¬äºŒä¸ª/ä¹‹é—´çš„å†…å®¹(ç±»åˆ«)
    var pageCategory = location.pathname.split('/')[1];

    [].forEach.call(list, function (navItem) {

      // è·å–æ¯ä¸ªå¯¼èˆªé“¾æ¥çš„ç±»åˆ«,ä¸å½“å‰é¡µé¢ç±»åˆ«æ¯”è¾ƒ,ç¡®å®šæ˜¯å¦é«˜äº®
      var navCategory = navItem.pathname.split('/')[1];
      if (navCategory === pageCategory) {
        navItem.parentNode.classList.add('active');
      }
    });

    // é¡µé¢å¯¼èˆª
    pageScroll.init({
      container: '.page-scroll-container'
    });
  }(window));
</script>

  </div>




  <!-- ç™¾åº¦ç»Ÿè®¡ -->
  <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?196ca8311083e8eb3b22232555273fa0";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>
<!-- end ç™¾åº¦ç»Ÿè®¡ -->

<!-- ç™¾åº¦é“¾æ¥è‡ªåŠ¨æäº¤ -->
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<!-- end ç™¾åº¦é“¾æ¥è‡ªåŠ¨æäº¤ -->

</body>
</html>
